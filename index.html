<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ğŸ„ ê³¨ë“œìŠ¤í… í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë£°ë ›</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: linear-gradient(180deg, #0f1c3f 0%, #1a3a5c 50%, #2d5a7b 100%);
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }
    
    /* ëˆˆ ë‚´ë¦¬ëŠ” íš¨ê³¼ */
    .snowflakes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }
    
    .snowflake {
      position: absolute;
      top: -20px;
      color: #fff;
      font-size: 20px;
      opacity: 0.8;
      animation: fall linear infinite;
    }
    
    @keyframes fall {
      0% { transform: translateY(-20px) rotate(0deg); }
      100% { transform: translateY(100vh) rotate(360deg); }
    }
    
    /* ì½˜í˜í‹° íš¨ê³¼ */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 200;
      overflow: hidden;
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      opacity: 0;
    }
    
    .confetti.active {
      animation: confetti-fall 3s ease-out forwards;
    }
    
    @keyframes confetti-fall {
      0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(100vh) rotate(720deg) scale(0.5);
      }
    }
    
    .container {
      max-width: 420px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 10;
    }
    
    .header {
      text-align: center;
      padding: 20px 0;
    }
    
    .title {
      font-size: 28px;
      font-weight: 900;
      color: #fff;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    
    .title-highlight {
      background: linear-gradient(135deg, #ff6b6b, #ffd93d);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      font-size: 15px;
      color: #ffd93d;
      margin-top: 10px;
      text-shadow: 0 1px 5px rgba(0,0,0,0.3);
    }
    
    .notice {
      font-size: 12px;
      color: #fff;
      background: rgba(255,107,107,0.8);
      padding: 6px 18px;
      border-radius: 20px;
      display: inline-block;
      margin-top: 12px;
      font-weight: 600;
    }
    
    .roulette-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px 0;
    }
    
    .wheel-wrapper {
      position: relative;
    }
    
    .pointer {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 40px;
      z-index: 10;
      filter: drop-shadow(0 3px 6px rgba(0,0,0,0.5));
      animation: bounce 1s ease infinite;
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(5px); }
    }
    
    #wheel {
      width: 320px;
      height: 320px;
      border-radius: 50%;
      box-shadow: 
        0 0 0 10px #c41e3a,
        0 0 0 16px #228b22,
        0 0 0 20px #c41e3a,
        0 0 50px rgba(255,215,0,0.4);
    }
    
    .spin-btn {
      margin-top: 30px;
      padding: 18px 55px;
      font-size: 20px;
      font-weight: 700;
      color: #fff;
      background: linear-gradient(135deg, #c41e3a, #a01830);
      border: 3px solid #ffd700;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 25px rgba(196,30,58,0.5);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .spin-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 30px rgba(196,30,58,0.6);
    }
    
    .spin-btn:disabled {
      background: #555;
      border-color: #888;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    
    .info-section {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 25px;
      margin-top: 25px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .info-section h3 {
      font-size: 15px;
      color: #ffd700;
      margin-bottom: 15px;
    }
    
    .info-section p {
      font-size: 13px;
      color: rgba(255,255,255,0.85);
      line-height: 2;
    }
    
    .info-section strong {
      color: #ff6b6b;
    }
    
    /* ëª¨ë‹¬ */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
      z-index: 100;
      padding: 20px;
    }
    
    .modal.show { display: flex; }
    
    .modal-box {
      background: linear-gradient(180deg, #1a3a5c, #0f1c3f);
      border: 3px solid #ffd700;
      border-radius: 25px;
      padding: 40px 30px;
      text-align: center;
      max-width: 340px;
      width: 100%;
      animation: popIn 0.4s ease;
      box-shadow: 0 0 50px rgba(255,215,0,0.3);
    }
    
    @keyframes popIn {
      0% { transform: scale(0.7); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .modal-emoji { font-size: 55px; }
    
    .modal-title {
      font-size: 26px;
      color: #ffd700;
      margin: 15px 0;
      text-shadow: 0 2px 10px rgba(255,215,0,0.3);
    }
    
    .modal-prize {
      background: rgba(255,255,255,0.1);
      border-radius: 20px;
      padding: 25px;
      margin: 20px 0;
    }
    
    .modal-prize img {
      width: 130px;
      height: 130px;
      object-fit: contain;
      border-radius: 15px;
      background: #fff;
      padding: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    }
    
    .modal-prize-text {
      font-size: 24px;
      font-weight: 900;
      color: #fff;
      margin-top: 15px;
    }
    
    .modal-desc {
      font-size: 14px;
      color: rgba(255,255,255,0.8);
      margin-bottom: 25px;
    }
    
    .modal-btn {
      display: block;
      width: 100%;
      padding: 18px;
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      background: linear-gradient(135deg, #228b22, #1a6b1a);
      border: 2px solid #90ee90;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(34,139,34,0.4);
      transition: transform 0.2s;
    }
    
    .modal-btn:hover {
      transform: scale(1.03);
    }
    
    .modal-timer {
      margin-top: 18px;
      font-size: 13px;
      color: #ff6b6b;
    }
    
    .modal-note {
      margin-top: 12px;
      font-size: 11px;
      color: rgba(255,255,255,0.5);
    }
    
    /* ì¥ì‹ */
    .deco {
      position: absolute;
      font-size: 30px;
      opacity: 0.6;
    }
    .deco-1 { top: 10%; left: 5%; animation: float 3s ease-in-out infinite; }
    .deco-2 { top: 15%; right: 8%; animation: float 3.5s ease-in-out infinite; }
    .deco-3 { bottom: 20%; left: 8%; animation: float 4s ease-in-out infinite; }
    .deco-4 { bottom: 15%; right: 5%; animation: float 3.2s ease-in-out infinite; }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <!-- ëˆˆ ë‚´ë¦¬ëŠ” íš¨ê³¼ -->
  <div class="snowflakes" id="snowflakes"></div>
  
  <!-- ì½˜í˜í‹° ì»¨í…Œì´ë„ˆ -->
  <div class="confetti-container" id="confetti-container"></div>
  
  <!-- ì¥ì‹ -->
  <div class="deco deco-1">ğŸ„</div>
  <div class="deco deco-2">â­</div>
  <div class="deco deco-3">ğŸ</div>
  <div class="deco deco-4">ğŸ””</div>
  
  <div class="container">
    <header class="header">
      <h1 class="title">ğŸ„ <span class="title-highlight">í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë£°ë ›</span> ğŸ…</h1>
      <p class="subtitle">100% ë‹¹ì²¨! ì§€ê¸ˆ ë°”ë¡œ ëŒë ¤ë³´ì„¸ìš”</p>
      <p class="notice">â€» ì‹ ê·œ íšŒì› ì „ìš© ì´ë²¤íŠ¸</p>
    </header>
    
    <section class="roulette-section">
      <div class="wheel-wrapper">
        <div class="pointer">ğŸ“</div>
        <canvas id="wheel"></canvas>
      </div>
      <button id="spinBtn" class="spin-btn">ğŸ° ë£°ë › ëŒë¦¬ê¸°</button>
    </section>
    
    <section class="info-section">
      <h3>ğŸ“Œ ìœ ì˜ì‚¬í•­</h3>
      <p>
        â€¢ ë³¸ ì´ë²¤íŠ¸ëŠ” <strong>ì‹ ê·œ íšŒì› ì „ìš©</strong>ì…ë‹ˆë‹¤.<br>
        â€¢ ë£°ë › ì°¸ì—¬ í›„ ì•± ì„¤ì¹˜ ë° ê°€ì… ì‹œ ìƒí’ˆ ì§€ê¸‰<br>
        â€¢ ì´ë²¤íŠ¸ ê¸°ê°„: 2025.12.22 ~ 12.28
      </p>
    </section>
  </div>
  
  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div id="modal" class="modal">
    <div class="modal-box">
      <div class="modal-emoji">ğŸ‰</div>
      <h2 class="modal-title">ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
      <div class="modal-prize">
        <img id="prizeImg" src="" alt="">
        <p id="prizeText" class="modal-prize-text"></p>
      </div>
      <p class="modal-desc">ì•± ì„¤ì¹˜í•˜ê³  ë°”ë¡œ ë°›ì•„ê°€ì„¸ìš”!</p>
      <button id="downloadBtn" class="modal-btn">ğŸ ì§€ê¸ˆ ë°›ìœ¼ëŸ¬ ê°€ê¸°</button>
      <p class="modal-timer">â° 24ì‹œê°„ ë‚´ ì„¤ì¹˜ ì‹œ ìœ íš¨</p>
      <p class="modal-note">â€» í˜„ì¬ Androidë§Œ ì§€ì›ë©ë‹ˆë‹¤</p>
    </div>
  </div>

  <script>
    // ============================================
    // ğŸ”§ ì„¤ì •
    // ============================================
    const CONFIG = {
      // âœ… ì•±ìŠ¤í”Œë¼ì´ì–´ OneLink URL
      ONELINK_BASE: 'https://goldstep.onelink.me/3a1d/ybq9vmeu',
      
      // í”Œë ˆì´ìŠ¤í† ì–´ URL (í´ë°±ìš©)
      PLAYSTORE_URL: 'https://play.google.com/store/apps/details?id=com.goldmanbo.circle&hl=ko',
      
      // ìº í˜ì¸ ì •ë³´
      CAMPAIGN: 'christmas_roulette_2025',
      MEDIA_SOURCE: 'web_roulette'
    };

    // ============================================
    // ğŸ ìƒí’ˆ ë°ì´í„° (6ê°œ) - ìµœì¢… í™•ì •!
    // ============================================
    const PRIZES = [
      { id: 'shinramen',   text: 'ì‹ ë¼ë©´ ì†Œì»µ',     image: 'images/shinramen.png',   price: 1170, prob: 18 },
      { id: 'jayusigan',   text: 'ììœ ì‹œê°„',        image: 'images/jayusigan.png',   price: 1120, prob: 18 },
      { id: 'kimchi',      text: 'ê¹€ì¹˜ ì‚¬ë°œë©´',     image: 'images/kimchi.png',      price: 1030, prob: 18 },
      { id: 'yukgaejang',  text: 'ìœ¡ê°œì¥ ì‚¬ë°œë©´',   image: 'images/yukgaejang.png',  price: 1030, prob: 18 },
      { id: 'gatorade',    text: 'ê²Œí† ë ˆì´ ë ˆëª¬',   image: 'images/gatorade.png',    price: 1120, prob: 14 },
      { id: 'chocosongyi', text: 'ì´ˆì½”ì†¡ì´',        image: 'images/chocosongyi.png', price: 1120, prob: 14 }
    ];

    const WHEEL_COLORS = ['#ffffff', '#e8e8e8', '#ffffff', '#e8e8e8', '#ffffff', '#e8e8e8'];

    // ============================================
    // â„ï¸ ëˆˆ ë‚´ë¦¬ëŠ” íš¨ê³¼
    // ============================================
    function createSnowflakes() {
      const container = document.getElementById('snowflakes');
      const snowflakeChars = ['â„', 'â…', 'â†', 'âœ¦', 'â€¢'];
      
      for (let i = 0; i < 50; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        snowflake.textContent = snowflakeChars[Math.floor(Math.random() * snowflakeChars.length)];
        snowflake.style.left = Math.random() * 100 + '%';
        snowflake.style.fontSize = (Math.random() * 15 + 10) + 'px';
        snowflake.style.opacity = Math.random() * 0.6 + 0.2;
        snowflake.style.animationDuration = (Math.random() * 5 + 5) + 's';
        snowflake.style.animationDelay = (Math.random() * 10) + 's';
        container.appendChild(snowflake);
      }
    }
    createSnowflakes();

    // ============================================
    // ğŸŠ ì½˜í˜í‹° íš¨ê³¼
    // ============================================
    function createConfetti() {
      const container = document.getElementById('confetti-container');
      container.innerHTML = '';
      
      const colors = ['#ff6b6b', '#ffd93d', '#6bcf63', '#4dabf7', '#cc5de8', '#ff922b', '#fff'];
      const shapes = ['â– ', 'â—', 'â–²', 'â˜…', 'â™¦', 'â—'];
      
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.top = '-20px';
        confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.fontSize = (Math.random() * 15 + 10) + 'px';
        confetti.style.animationDelay = (Math.random() * 0.5) + 's';
        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
        container.appendChild(confetti);
        
        setTimeout(() => {
          confetti.classList.add('active');
        }, 50);
      }
      
      setTimeout(() => {
        container.innerHTML = '';
      }, 4000);
    }

    // ============================================
    // ğŸ¨ ê³ í•´ìƒë„ ìº”ë²„ìŠ¤ ì„¤ì •
    // ============================================
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    
    const displaySize = 320;
    const scale = 2;
    canvas.width = displaySize * scale;
    canvas.height = displaySize * scale;
    canvas.style.width = displaySize + 'px';
    canvas.style.height = displaySize + 'px';
    ctx.scale(scale, scale);
    
    const centerX = displaySize / 2;
    const centerY = displaySize / 2;
    const radius = displaySize / 2 - 5;

    let currentAngle = 0;
    let imagesLoaded = 0;
    const prizeImages = [];

    // ì´ë¯¸ì§€ ë¯¸ë¦¬ ë¡œë“œ
    PRIZES.forEach((prize, i) => {
      const img = new Image();
      img.onload = () => {
        imagesLoaded++;
        if (imagesLoaded === PRIZES.length) drawWheel();
      };
      img.onerror = () => {
        imagesLoaded++;
        if (imagesLoaded === PRIZES.length) drawWheel();
      };
      img.src = prize.image;
      prizeImages[i] = img;
    });

    function drawWheel() {
      const sliceAngle = (2 * Math.PI) / PRIZES.length;
      
      PRIZES.forEach((prize, i) => {
        const startAngle = currentAngle + i * sliceAngle;
        const endAngle = startAngle + sliceAngle;
        
        // ì¡°ê° ê·¸ë¦¬ê¸° (í°/íšŒìƒ‰)
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.arc(centerX, centerY, radius, startAngle, endAngle);
        ctx.closePath();
        ctx.fillStyle = WHEEL_COLORS[i];
        ctx.fill();
        ctx.strokeStyle = '#ccc';
        ctx.lineWidth = 1;
        ctx.stroke();
        
        // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(startAngle + sliceAngle / 2);
        
        const imgSize = 65;
        const imgX = radius - 100;
        const imgY = -imgSize / 2;
        
        if (prizeImages[i] && prizeImages[i].complete && prizeImages[i].naturalWidth > 0) {
          ctx.shadowColor = 'rgba(0,0,0,0.2)';
          ctx.shadowBlur = 8;
          ctx.shadowOffsetY = 3;
          
          ctx.beginPath();
          ctx.arc(imgX + imgSize/2, 0, imgSize/2 + 5, 0, 2 * Math.PI);
          ctx.fillStyle = '#fff';
          ctx.fill();
          
          ctx.shadowColor = 'transparent';
          ctx.strokeStyle = '#ddd';
          ctx.lineWidth = 2;
          ctx.stroke();
          
          ctx.save();
          ctx.beginPath();
          ctx.arc(imgX + imgSize/2, 0, imgSize/2, 0, 2 * Math.PI);
          ctx.clip();
          ctx.drawImage(prizeImages[i], imgX, imgY, imgSize, imgSize);
          ctx.restore();
        }
        
        ctx.restore();
      });
      
      // ì¤‘ì•™ ì›
      ctx.shadowColor = 'rgba(0,0,0,0.3)';
      ctx.shadowBlur = 10;
      ctx.beginPath();
      ctx.arc(centerX, centerY, 35, 0, 2 * Math.PI);
      ctx.fillStyle = '#c41e3a';
      ctx.fill();
      ctx.shadowColor = 'transparent';
      ctx.strokeStyle = '#ffd700';
      ctx.lineWidth = 4;
      ctx.stroke();
      
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 14px Noto Sans KR';
      ctx.textAlign = 'center';
      ctx.fillText('SPIN', centerX, centerY + 5);
    }

    setTimeout(drawWheel, 100);

    // ============================================
    // ğŸ² í™•ë¥  ê¸°ë°˜ ì„ íƒ
    // ============================================
    function selectPrize() {
      const total = PRIZES.reduce((sum, p) => sum + p.prob, 0);
      let rand = Math.random() * total;
      for (const prize of PRIZES) {
        rand -= prize.prob;
        if (rand <= 0) return prize;
      }
      return PRIZES[0];
    }

    // ============================================
    // ğŸ“± ë””ë°”ì´ìŠ¤ ê°ì§€
    // ============================================
    function isAndroid() {
      return /Android/i.test(navigator.userAgent);
    }
    
    function isIOS() {
      return /iPhone|iPad|iPod/i.test(navigator.userAgent);
    }

    // ============================================
    // ğŸ”— ì•±ìŠ¤í”Œë¼ì´ì–´ OneLink URL ìƒì„±
    // ============================================
    function generateOneLinkUrl(prize) {
      const params = new URLSearchParams({
        // ì•±ìŠ¤í”Œë¼ì´ì–´ ì–´íŠ¸ë¦¬ë·°ì…˜ íŒŒë¼ë¯¸í„°
        pid: CONFIG.MEDIA_SOURCE,
        c: CONFIG.CAMPAIGN,
        
        // ë”¥ë§í¬ íŒŒë¼ë¯¸í„° (ì•±ì—ì„œ ë°›ì„ ë°ì´í„°)
        deep_link_value: 'christmas_event',
        deep_link_sub1: prize.id,
        deep_link_sub2: prize.text,
        deep_link_sub3: prize.price
      });
      
      return `${CONFIG.ONELINK_BASE}?${params.toString()}`;
    }

    // ============================================
    // ğŸ¡ ë£°ë › íšŒì „
    // ============================================
    let isSpinning = false;
    const spinBtn = document.getElementById('spinBtn');

    spinBtn.addEventListener('click', () => {
      if (isSpinning) return;
      isSpinning = true;
      spinBtn.disabled = true;
      spinBtn.textContent = 'ëŒì•„ê°€ëŠ” ì¤‘...';

      const prize = selectPrize();
      const prizeIndex = PRIZES.indexOf(prize);
      const sliceAngle = 360 / PRIZES.length;
      
      const targetAngle = 360 - (prizeIndex * sliceAngle + sliceAngle / 2) - 90;
      const totalRotation = 360 * 6 + targetAngle;
      
      let start = null;
      const duration = 5000;
      const startAngleDeg = currentAngle * 180 / Math.PI;

      function animate(timestamp) {
        if (!start) start = timestamp;
        const progress = Math.min((timestamp - start) / duration, 1);
        
        const easeOut = 1 - Math.pow(1 - progress, 3);
        currentAngle = (startAngleDeg + totalRotation * easeOut) * Math.PI / 180;
        
        ctx.clearRect(0, 0, displaySize, displaySize);
        drawWheel();
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          isSpinning = false;
          showModal(prize);
        }
      }
      
      requestAnimationFrame(animate);
    });

    // ============================================
    // ğŸŠ ê²°ê³¼ ëª¨ë‹¬
    // ============================================
    function showModal(prize) {
      // ì½˜í˜í‹° íš¨ê³¼!
      createConfetti();
      
      document.getElementById('prizeImg').src = prize.image;
      document.getElementById('prizeText').textContent = prize.text + ' ë‹¹ì²¨!';
      document.getElementById('modal').classList.add('show');
      
      // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­
      document.getElementById('downloadBtn').onclick = () => {
        if (isAndroid()) {
          // ì•ˆë“œë¡œì´ë“œ: OneLinkë¡œ ì´ë™
          const oneLinkUrl = generateOneLinkUrl(prize);
          console.log('OneLink URL:', oneLinkUrl);
          window.location.href = oneLinkUrl;
        } else if (isIOS()) {
          // iOS: ì¤€ë¹„ ì¤‘ ì•ˆë‚´
          alert('iOS ë²„ì „ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤! ğŸ™\nì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
        } else {
          // PC: í”Œë ˆì´ìŠ¤í† ì–´ë¡œ ì´ë™
          window.location.href = CONFIG.PLAYSTORE_URL;
        }
      };
    }
  </script>
</body>
</html>
